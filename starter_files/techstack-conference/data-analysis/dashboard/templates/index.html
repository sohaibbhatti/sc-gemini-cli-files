{% extends "base.html" %}

{% block content %}
<div class="metrics-grid">
    <div class="metric-card">
        <h3>Total Leads</h3>
        <div class="metric-value">{{ metrics.total }}</div>
    </div>
    <div class="metric-card hot">
        <h3>Hot Leads</h3>
        <div class="metric-value">{{ metrics.hot }}</div>
    </div>
    <div class="metric-card warm">
        <h3>Warm Leads</h3>
        <div class="metric-value">{{ metrics.warm }}</div>
    </div>
    <div class="metric-card cold">
        <h3>Cold Leads</h3>
        <div class="metric-value">{{ metrics.cold }}</div>
    </div>
</div>

<div class="charts-grid">
    <div class="chart-container">
        <h2>Lead Segments</h2>
        <canvas id="segmentChart"></canvas>
    </div>
    <div class="chart-container">
        <h2>Top 5 Companies</h2>
        <canvas id="companyChart"></canvas>
    </div>
    <div class="chart-container" style="grid-column: span 2;">
        <h2>Top Countries</h2>
        <canvas id="countryChart"></canvas>
    </div>
</div>

<script>
fetch('/api/stats')
    .then(response => response.json())
    .then(data => {
        // Segment Pie Chart
        new Chart(document.getElementById('segmentChart'), {
            type: 'pie',
            data: {
                labels: Object.keys(data.segments),
                datasets: [{
                    data: Object.values(data.segments),
                    backgroundColor: ['#ef4444', '#f59e0b', '#3b82f6']
                }]
            }
        });

        // Company Bar Chart
        new Chart(document.getElementById('companyChart'), {
            type: 'bar',
            data: {
                labels: Object.keys(data.companies),
                datasets: [{
                    label: 'Leads',
                    data: Object.values(data.companies),
                    backgroundColor: '#6366f1'
                }]
            },
            options: {
                indexAxis: 'y',
                plugins: { legend: { display: false } }
            }
        });

        // Country Bar Chart
        new Chart(document.getElementById('countryChart'), {
            type: 'bar',
            data: {
                labels: Object.keys(data.countries),
                datasets: [{
                    label: 'Leads per Country',
                    data: Object.values(data.countries),
                    backgroundColor: '#f43f5e'
                }]
            },
            options: {
                plugins: { legend: { display: false } }
            }
        });
    });
</script>
{% endblock %}
